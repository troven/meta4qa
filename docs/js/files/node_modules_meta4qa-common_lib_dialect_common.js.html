<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>node_modules/meta4qa-common/lib/dialect/common.js - meta4qa</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/img/logo.png" title="meta4qa" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>Dialect Definitions for: 1.2.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Phrases</a></li>
                            <li><a href="#api-modules">Dialects</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Builder.html">Builder</a></li>
                                <li><a href="../classes/Common.html">Common</a></li>
                                <li><a href="../classes/Events.html">Events</a></li>
                                <li><a href="../classes/File System.html">File System</a></li>
                                <li><a href="../classes/TCP Toolkit.html">TCP Toolkit</a></li>
                                <li><a href="../classes/Transform.html">Transform</a></li>
                                <li><a href="../classes/Variables.html">Variables</a></li>
                                <li><a href="../classes/Web API.html">Web API</a></li>
                                <li><a href="../classes/X.509 Server Certificates.html">X.509 Server Certificates</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/Default Dialect.html">Default Dialect</a></li>
                                <li><a href="../modules/Web API Dialect.html">Web API Dialect</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: node_modules/meta4qa-common/lib/dialect/common.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
var assert = require(&#x27;assert&#x27;);
var request = require(&#x27;request&#x27;);
var _ = require(&#x27;underscore&#x27;);
var path = require(&#x27;path&#x27;);
var debug = require(&#x27;debug&#x27;)(&#x27;meta4qa:dialect:common&#x27;);
var log = require(&#x27;debug&#x27;)(&#x27;meta4qa:log&#x27;);
var error = require(&#x27;debug&#x27;)(&#x27;meta4qa:error&#x27;);
var child_process = require(&#x27;child_process&#x27;);

var meta4qa = require(&#x27;meta4qa&#x27;),
    helps = meta4qa.helpers,
    files = helps.files,
    http = helps.http;

/**
 * Useful
 * Configures the Gherkin parser with phrases that support common, useful operations
 *
 * @module Default Dialect
 * @class Common
 *
 */

var self = module.exports = function(learn, config, dialect) {
    assert(learn, &quot;missing learn&quot;);
    assert(config, &quot;missing config&quot;);
    assert(dialect, &quot;missing dialect&quot;);
    assert(helps, &quot;missing helpers&quot;);

    Array.prototype.contains = function(element){
        return this.indexOf(element) &gt; -1;
    };

    learn.given([&quot;I am $actor&quot;, &quot;I am a $actor&quot;, &quot;I am an $actor&quot;], function(actor, done) {
        assert(actor, &quot;Missing $actor&quot;);
        debug(&quot;We are &quot;+actor);
        this.vars.name = actor;
        done &amp;&amp; done();
    });

    learn.given([&quot;I want $outcome&quot;, &quot;I want a $outcome&quot;, &quot;I want an $outcome&quot;, &quot;I want some $outcome&quot;, &quot;I want to $outcome&quot;], function(outcome, done) {
        assert(outcome, &quot;Missing $outcome&quot;);
        debug(&quot;We want &quot;+outcome);
        this.vars.name = outcome;
        done &amp;&amp; done();
    });

    learn.when([&quot;debug $msg&quot;], function(msg, done) {
        debug(msg);
        done &amp;&amp; done();
    });

    learn.when([&quot;log $msg&quot;], function(msg, done) {
        log(msg);
        done &amp;&amp; done();
    });

    learn.when([&quot;error $msg&quot;], function(msg, done) {
        error(msg);
        done &amp;&amp; done();
    });

    learn.then([&quot;dump $varname&quot;, &quot;I dump $varname&quot;], function(name, done) {
        assert(name, &quot;Missing $varname&quot;)
        debug(&quot;dump %s in current scope&quot;, name);
        var found = helps.vars.findNamed(this, name);
        console.log(&quot;\t%s ==&gt;\n%j&quot;, name, (found || &quot;Not Found&quot;) );
        done &amp;&amp; done();
    });

    learn.then([&quot;dump&quot;, &quot;I dump&quot;], function(done) {
        debug(&quot;dump current scope&quot;);
        console.log(&quot;%j&quot;, this);
        done &amp;&amp; done();
    });

    learn.then([&quot;I fail&quot;], function(done) {
        debug(&quot;doh !!&quot;);
        throw new Error(&quot;Deliberate Fail&quot;);
    });

    learn.then([&quot;I fail with $msg&quot;], function(msg, done) {
        debug(&quot;doh !! %s&quot;, msg);
        throw new Error(&quot;Deliberate Fail: &quot;+msg);
    });

    learn.then([&quot;I pass&quot;, &quot;I do nothing&quot;, &quot;I succeed&quot;], function(done) {
        debug(&quot;meta4qas are Awesome !!&quot;);
        done &amp;&amp; done();
    });

    learn.when([&quot;I wait $time $units&quot;, &quot;I wait for $time $units&quot;], function(time, units, done) {
        var scale = 1000;
        switch(units) {
            case &quot;m&quot;:
            case &quot;min&quot;:
            case &quot;mins&quot;:
            case &quot;minute&quot;:
            case &quot;minutes&quot;:
                scale = 60*1000; break;
            case &quot;s&quot;:
            case &quot;second&quot;:
            case &quot;seconds&quot;:
                scale = 1000; break;
            case &quot;ms&quot;:
            case &quot;millsecond&quot;:
            case &quot;millseconds&quot;:
                scale = 1; break;
            default:
                scale = 1000; break;
        }
        var wait = time * scale;
        debug(&quot;waiting &quot;+wait+&quot; ms&quot;);
        done &amp;&amp; setTimeout(done, wait);
    });

    learn.when([&quot;I run $filename&quot;], function(command, done) {
        var self = this;
        debug (&quot;CLI Run %s from %s&quot;, command, process.cwd());
        child_process.execFile(command, {}, {
            cwd: process.cwd()
        }, function(err, stdout, stderr) {
            debug (&quot;Finished Run: %s -&gt; %s&quot;, command, err);
            assert(!err, &quot;RUN: &quot;+command+&quot; -&gt; &quot;+err);
            self.stdout = stdout;
            self.stderr = stderr;
            done &amp;&amp; done();
        })
    });

    learn.when([&quot;I exec $command&quot;], function(command, done) {
        var self = this;
        debug (&quot;CLI Exec: %s from %s&quot;, command, process.cwd());
        child_process.exec(command, {}, {
            cwd: process.cwd()
        }, function(err, stdout, stderr) {
            debug (&quot;Finished Exec: %s -&gt; %s&quot;, command, err);
            assert(!err, &quot;EXEC: &quot;+command+&quot; -&gt; &quot;+err);
            self.stdout = stdout;
            self.stderr = stderr;
            done &amp;&amp; done();
        })
    });

    // **********************************************************************
    // * Dialect Controller
    // **********************************************************************

    self.feature = function(dialect, scope) {
        assert(dialect, &quot;missing dialect&quot;);
        assert(scope, &quot;missing scope&quot;);
    };

    self.scenario = function(dialect, scope) {
        assert(dialect, &quot;missing dialect&quot;);
        assert(scope, &quot;missing scope&quot;);
    };

    self.annotations = function(dialect, annotations, scope, scope2) {
        assert(dialect, &quot;missing dialect&quot;);
        assert(annotations, &quot;missing annotations&quot;);
        assert(scope, &quot;missing scope&quot;);

        _.defaults(scope, { stopwatch: {} });

        // dynamic dialects
        var dialects = [];
        if (_.isString(annotations.dialects)) dialects.push(annotations.dialects);
        if (_.isArray(annotations.dialects)) dialects.concat(annotations.dialects);
        if (_.isString(annotations.dialect)) dialects.push(annotations.dialect);
        if (_.isArray(annotations.dialect)) dialects.concat(annotations.dialect);

        if (annotations.timeout &amp;&amp; scope2 &amp;&amp; _.isFunction(scope2.timeout)) {
            debug(&quot;timeout: %s&quot;, annotations.timeout);
            scope2.timeout(annotations.timeout);
        }
        dialect.requires(dialects);
        scope.dialects = dialects;
    }

    debug(&quot;common terms&quot;);
    return self;
}


    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
